<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>To-Do List</title>
    <link href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
   <style>
    /* styles.css */

body {
    background: #f4f4f9;
    color: #333;
}

h1 {
    margin: 0;
    font-size: 1.75rem;
}

.theme-switcher {
    display: flex;
    align-items: center;
}

#task-input, #due-date, #priority, #category, #search-input, #edit-task-input, #edit-due-date, #edit-priority, #edit-category, #edit-description, #edit-subtasks {
    border-radius: 0.25rem;
}

#add-btn, #sort-btn {
    border-radius: 0.25rem;
}

#task-list {
    margin-top: 20px;
}

.list-group-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.task-details {
    display: flex;
    align-items: center;
    gap: 10px;
}

.dark-theme body {
    background: #333;
    color: #fff;
}

.dark-theme .list-group-item {
    background: #444;
    border-color: #555;
}

.dark-theme .form-control, .dark-theme .btn {
    background: #555;
    color: #fff;
    border: none;
}

.progress {
    height: 20px;
}

.progress-bar {
    background-color: #28a745;
}

.card {
    margin-bottom: 15px;
}

.card-body {
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.card .task-details {
    flex-direction: column;
    align-items: flex-start;
}

.card .actions {
    display: flex;
    gap: 10px;
}

   </style>
</head>
<body>
    <div class="container mt-5">
        <header class="d-flex justify-content-between align-items-center mb-4">
            <h1>To-Do List</h1>
            <div class="theme-switcher">
                <label for="theme">Theme:</label>
                <select id="theme" class="form-control ml-2">
                    <option value="light">Light</option>
                    <option value="dark">Dark</option>
                </select>
            </div>
        </header>
        <main>
            <div class="input-group mb-3">
                <input type="text" id="task-input" class="form-control" placeholder="Add a new task...">
                <input type="date" id="due-date" class="form-control ml-2">
                <select id="priority" class="form-control ml-2">
                    <option value="low">Low</option>
                    <option value="medium">Medium</option>
                    <option value="high">High</option>
                </select>
                <input type="text" id="category" class="form-control ml-2" placeholder="Category">
                <div class="input-group-append">
                    <button id="add-btn" class="btn btn-primary">Add Task</button>
                </div>
            </div>
            <div class="input-group mb-3">
                <input type="text" id="search-input" class="form-control" placeholder="Search tasks...">
                <div class="input-group-append">
                    <button id="sort-btn" class="btn btn-secondary dropdown-toggle" data-toggle="dropdown">Sort By</button>
                    <div class="dropdown-menu">
                        <a class="dropdown-item" href="#" onclick="sortTasks('dueDate')">Due Date</a>
                        <a class="dropdown-item" href="#" onclick="sortTasks('priority')">Priority</a>
                        <a class="dropdown-item" href="#" onclick="sortTasks('category')">Category</a>
                    </div>
                </div>
            </div>
            <ul id="task-list" class="list-group"></ul>
            <div class="progress mt-4">
                <div id="progress-bar" class="progress-bar" role="progressbar" style="width: 0%"></div>
            </div>
        </main>
    </div>
    <!-- Modal for editing task -->
    <div class="modal fade" id="editTaskModal" tabindex="-1" aria-labelledby="editTaskModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="editTaskModalLabel">Edit Task</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <form id="edit-task-form">
                        <div class="form-group">
                            <label for="edit-task-input">Task</label>
                            <input type="text" class="form-control" id="edit-task-input">
                        </div>
                        <div class="form-group">
                            <label for="edit-due-date">Due Date</label>
                            <input type="date" class="form-control" id="edit-due-date">
                        </div>
                        <div class="form-group">
                            <label for="edit-priority">Priority</label>
                            <select class="form-control" id="edit-priority">
                                <option value="low">Low</option>
                                <option value="medium">Medium</option>
                                <option value="high">High</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="edit-category">Category</label>
                            <input type="text" class="form-control" id="edit-category">
                        </div>
                        <div class="form-group">
                            <label for="edit-description">Description</label>
                            <textarea class="form-control" id="edit-description" rows="3"></textarea>
                        </div>
                        <div class="form-group">
                            <label for="edit-subtasks">Subtasks</label>
                            <input type="text" class="form-control" id="edit-subtasks" placeholder="Comma separated subtasks">
                        </div>
                        <button type="submit" class="btn btn-primary">Save changes</button>
                    </form>
                </div>
            </div>
        </div>
    </div>
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <script>
        // script.js

document.addEventListener('DOMContentLoaded', () => {
    const taskInput = document.getElementById('task-input');
    const addBtn = document.getElementById('add-btn');
    const taskList = document.getElementById('task-list');
    const themeSelect = document.getElementById('theme');
    const dueDateInput = document.getElementById('due-date');
    const priorityInput = document.getElementById('priority');
    const categoryInput = document.getElementById('category');
    const searchInput = document.getElementById('search-input');
    const progressBar = document.getElementById('progress-bar');

    // Load saved tasks and theme from local storage
    loadTasks();
    loadTheme();

    // Add new task
    addBtn.addEventListener('click', () => {
        const taskText = taskInput.value.trim();
        const dueDate = dueDateInput.value;
        const priority = priorityInput.value;
        const category = categoryInput.value.trim();
        if (taskText) {
            const task = {
                text: taskText,
                dueDate: dueDate,
                priority: priority,
                category: category,
                description: '',
                subtasks: [],
                completed: false
            };
            addTask(task);
            saveTask(task);
            taskInput.value = '';
            dueDateInput.value = '';
            priorityInput.value = 'low';
            categoryInput.value = '';
        }
    });

    // Theme switcher
    themeSelect.addEventListener('change', () => {
        document.body.classList.toggle('dark-theme', themeSelect.value === 'dark');
        localStorage.setItem('theme', themeSelect.value);
    });

    // Search functionality
    searchInput.addEventListener('input', () => {
        const searchTerm = searchInput.value.toLowerCase();
        const tasks = document.querySelectorAll('.list-group-item');
        tasks.forEach(task => {
            const taskText = task.querySelector('.task-text').innerText.toLowerCase();
            if (taskText.includes(searchTerm)) {
                task.style.display = '';
            } else {
                task.style.display = 'none';
            }
        });
    });

    // Load tasks from local storage
    function loadTasks() {
        const tasks = JSON.parse(localStorage.getItem('tasks')) || [];
        tasks.forEach(task => addTask(task));
        updateProgress();
    }

    // Load theme from local storage
    function loadTheme() {
        const theme = localStorage.getItem('theme') || 'light';
        themeSelect.value = theme;
        document.body.classList.toggle('dark-theme', theme === 'dark');
    }

    // Add task to the DOM
    function addTask(task) {
        const li = document.createElement('li');
        li.className = 'list-group-item';
        li.innerHTML = `
            <div class="card">
                <div class="card-body">
                    <div class="task-details">
                        <span class="task-text">${task.text}</span>
                        <span class="badge badge-${getPriorityBadge(task.priority)}">${task.priority}</span>
                        <span class="badge badge-secondary">${task.category}</span>
                        <span class="badge badge-info">${task.dueDate}</span>
                    </div>
                    <div class="actions">
                        <button class="btn btn-sm btn-info" onclick="editTask(this)" data-toggle="tooltip" title="Edit Task">Edit</button>
                        <button class="btn btn-sm btn-danger" onclick="deleteTask(this)" data-toggle="tooltip" title="Delete Task">Delete</button>
                        <button class="btn btn-sm btn-success" onclick="completeTask(this)" data-toggle="tooltip" title="Complete Task">Complete</button>
                    </div>
                </div>
            </div>
        `;
        if (task.completed) {
            li.querySelector('.task-text').style.textDecoration = 'line-through';
            li.querySelector('.task-text').style.color = 'grey';
        }
        taskList.appendChild(li);
        $('[data-toggle="tooltip"]').tooltip();
    }

    // Get badge class for priority
    function getPriorityBadge(priority) {
        if (priority === 'high') return 'danger';
        if (priority === 'medium') return 'warning';
        return 'success';
    }

    // Save task to local storage
    function saveTask(task) {
        const tasks = JSON.parse(localStorage.getItem('tasks')) || [];
        tasks.push(task);
        localStorage.setItem('tasks', JSON.stringify(tasks));
        updateProgress();
    }

    // Edit task
    window.editTask = function (button) {
        const taskItem = button.closest('li');
        const taskText = taskItem.querySelector('.task-text').innerText;
        const task = getTaskFromLocalStorage(taskText);
        $('#editTaskModal').modal('show');
        document.getElementById('edit-task-input').value = task.text;
        document.getElementById('edit-due-date').value = task.dueDate;
        document.getElementById('edit-priority').value = task.priority;
        document.getElementById('edit-category').value = task.category;
        document.getElementById('edit-description').value = task.description;
        document.getElementById('edit-subtasks').value = task.subtasks.join(', ');

        document.getElementById('edit-task-form').onsubmit = (event) => {
            event.preventDefault();
            task.text = document.getElementById('edit-task-input').value;
            task.dueDate = document.getElementById('edit-due-date').value;
            task.priority = document.getElementById('edit-priority').value;
            task.category = document.getElementById('edit-category').value;
            task.description = document.getElementById('edit-description').value;
            task.subtasks = document.getElementById('edit-subtasks').value.split(',').map(subtask => subtask.trim());
            updateTaskInLocalStorage(task);
            $('#editTaskModal').modal('hide');
            taskList.innerHTML = '';
            loadTasks();
        };
    };

    // Get task from local storage
    function getTaskFromLocalStorage(taskText) {
        const tasks = JSON.parse(localStorage.getItem('tasks')) || [];
        return tasks.find(task => task.text === taskText);
    }

    // Update task in local storage
    function updateTaskInLocalStorage(updatedTask) {
        let tasks = JSON.parse(localStorage.getItem('tasks'));
        tasks = tasks.map(task => task.text === updatedTask.text ? updatedTask : task);
        localStorage.setItem('tasks', JSON.stringify(tasks));
        updateProgress();
    }

    // Delete task
    window.deleteTask = function (button) {
        const taskItem = button.closest('li');
        const taskText = taskItem.querySelector('.task-text').innerText;
        taskList.removeChild(taskItem);
        deleteTaskFromLocalStorage(taskText);
    };

    // Delete task from local storage
    function deleteTaskFromLocalStorage(taskText) {
        let tasks = JSON.parse(localStorage.getItem('tasks'));
        tasks = tasks.filter(task => task.text !== taskText);
        localStorage.setItem('tasks', JSON.stringify(tasks));
        updateProgress();
    }

    // Complete task
    window.completeTask = function (button) {
        const taskItem = button.closest('li');
        const taskText = taskItem.querySelector('.task-text').innerText;
        const task = getTaskFromLocalStorage(taskText);
        task.completed = true;
        taskItem.querySelector('.task-text').style.textDecoration = 'line-through';
        taskItem.querySelector('.task-text').style.color = 'grey';
        updateTaskInLocalStorage(task);
        showNotification('Task Completed', `You completed: ${task.text}`);
    };

    // Update progress bar
    function updateProgress() {
        const tasks = JSON.parse(localStorage.getItem('tasks')) || [];
        const completedTasks = tasks.filter(task => task.completed).length;
        const totalTasks = tasks.length;
        const progress = totalTasks === 0 ? 0 : (completedTasks / totalTasks) * 100;
        progressBar.style.width = `${progress}%`;
    }

    // Show notification
    function showNotification(title, body) {
        if (Notification.permission === 'granted') {
            new Notification(title, { body });
        } else if (Notification.permission !== 'denied') {
            Notification.requestPermission().then(permission => {
                if (permission === 'granted') {
                    new Notification(title, { body });
                }
            });
        }
    }

    // Sort tasks
    window.sortTasks = function (criteria) {
        let tasks = JSON.parse(localStorage.getItem('tasks')) || [];
        tasks.sort((a, b) => {
            if (criteria === 'dueDate') {
                return new Date(a.dueDate) - new Date(b.dueDate);
            } else if (criteria === 'priority') {
                const priorities = { 'low': 1, 'medium': 2, 'high': 3 };
                return priorities[a.priority] - priorities[b.priority];
            } else if (criteria === 'category') {
                return a.category.localeCompare(b.category);
            }
        });
        localStorage.setItem('tasks', JSON.stringify(tasks));
        taskList.innerHTML = '';
        loadTasks();
    };
});

    </script>
</body>
</html>
